<html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<style type="text/css">
    div {
        margin: 20px
    }
</style>

<head>
    <script type="text/javascript" src="/js/jquery-2.2.4.js"></script>
    <script>
        // $(function () {
        //
        // });

        var importData = function () {

            var data = new FormData($("#multi-form")[0]);

            $.ajax({
                url: "/api/user/importData",
                success: function (result) {
                    alert(JSON.stringify(result));
                    // debugger;
                },
                contentType: false,
                processData: false,
                type: "POST",
                data: data
            });

            return false;
        };

        var exportData = function () {

            // $.ajax({
            //     url: "/api/user/exportData?param1=123",
            //     success: function (result) {
            //         // alert(JSON.stringify(result));
            //         // debugger;
            //     },
            //     type: "GET"
            // });

            window.location.href = "/api/user/exportData?param1=123";

        }


    </script>
</head>
<body>

<form action="javascript:void(0);" id="multi-form" enctype="multipart/form-data" onsubmit="importData();">

    导入：

    <hr>

    <div>Excel : <input id="upload_file" name="file" type="file"></div>
    <!--<div>Excel : <input id="upload_file" name="file" type="file" multiple ></div>-->
    <div>可选参数1 : <input id="param1" name="param1" type="text"></div>
    <div>可选参数2 : <input id="param2" name="param2" type="text"></div>
    <div><input type="submit" value="导入"></div>

</form>


<hr>
导出
<div><input type="button" value="导出" onclick="exportData();"></div>











<!-- 导入 -->
<button id="importButton" type="button" class="form-btn mu-btn mu-size-normal" onclick="file.click()">导入</button>
<form action="javascript:void(0);" id="multi-form2" enctype="multipart/form-data" onsubmit="">
    <input type="file" name="file" id="file" style="display: none;" onchange="importData();"/>
</form>
<script>
    var importData = function () {
        if($('#file').val() === ""){
            return;
        }
        var data = new FormData($("#multi-form")[0]);
        $.ajax({
            url: "/gfp.gbdp/gbdp/base-data/customer/organization/import",
            success: function (result) {
                alert(result.msg);
                // debugger;
                $('#file').val("");
            },
            error: function(){
                $('#file').val("");
            },
            contentType: false,
            processData: false,
            type: "POST",
            data: data
        });
        return false;
    };
</script>

</body>

</html>




















